function show_loader(){var a=$("#loader");$("body").css("opacity","0.8"),a.toggleClass("is-active")}function hide_loader(){var a=$("#loader");$("body").css("opacity","1"),a.toggleClass("is-active")}$("#add-event-btn").click(function(){$("#add-event").fadeToggle("fast")}),$("#add-event-do").click(function(){show_loader()}),$("#add-event form .close-btn").click(function(a){a.preventDefault(),$("#add-event").fadeToggle("fast")}),$("li.edit-event").click(function(){var a=$(this).data("event-id"),b=$(this).closest(".event-card"),c=b.find("h2").text().substring(5),d=b.find("span.event-description").text(),e=b.find("span.event-location").text(),f=b.find("span.event-address").text(),g=b.find("span.event-date").text(),h=b.find("span.event-password").text(),i=b.find("span.event-time").text(),j=b.find("span.event-rsvp-deadline").text();i.startsWith("0")&&(i=i.substring(1)),j.startsWith("0")&&(j=j.substring(1)),b.find("#details-"+a).fadeOut("fast",function(){b.find(".mdl-card__supporting-text").append('<form method="POST" id="edit-event-form"> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-name">Event Name</label> <input class="mdl-textfield__input" type="text" id="edit-event-name" name="edit-event-name" value="'+c+'"> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><textarea class="mdl-textfield__input" type="text" rows="3" id="edit-event-description" name="edit-event-description" >'+d+'</textarea><label class="mdl-textfield__label" for="edit-event-description">Description</label></div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-location">Location</label> <input class="mdl-textfield__input" type="text" id="edit-event-location" name="edit-event-location" value="'+e+'"> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-address">Address</label> <input class="mdl-textfield__input" type="text" id="edit-event-address" name="edit-event-address" value="'+f+'"> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-date">Date</label> <input class="mdl-textfield__input" type="text" id="edit-event-date" name="edit-event-date" pattern="^([0]?[1-9]|[1][0-2])[./-]([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0-9]{4}|[0-9]{2})$" placeholder="MM/DD/YYYY" value="'+g+'"> <span class="mdl-textfield__error">Please use this format: MM/DD/YYYY</span> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-time">Time</label> <input class="mdl-textfield__input" type="text" id="edit-event-time" name="edit-event-time" placeholder="XX:XX AM/PM" pattern="^ *(1[0-2]|[1-9]):[0-5][0-9] *(a|p|A|P)(m|M) *$" value="'+i+'"> <span class="mdl-textfield__error">Please use this format: XX:XX AM/PM</span> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label" for="edit-event-password">RSVP Password</label><input class="mdl-textfield__input" type="text" id="edit-event-password" name="edit-event-password" value="'+h+'"></div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-rsvp-deadline">RSVP Deadline <em>(Will be match event date if left empty)</em></label> <input class="mdl-textfield__input" type="text" id="edit-event-rsvp-deadline" name="edit-event-rsvp-deadline" pattern="^([0]?[1-9]|[1][0-2])[./-]([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0-9]{4}|[0-9]{2})$" placeholder="MM/DD/YYYY" value="'+j+'"> <span class="mdl-textfield__error">Please use this format: MM/DD/YYYY</span> </div> <input type="hidden" name="form-name" value="edit-event" /> <div class="form-buttons"> <div class="form-button"> <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" id="edit-event-do" type="submit" form="edit-event-form" data-event-id="'+a+'"> <i class="material-icons">add</i> </button> </div> <div class="form-button"> <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect edit-close-btn" data-event-id="'+a+'"><i class="material-icons">close</i> </button> </div> </div> </form>').fadeIn(),componentHandler.upgradeDom()})}),$("body").on("click",".edit-close-btn",function(a){a.preventDefault();var b=$(this).data("event-id"),c=$(this).closest(".event-card");$("#edit-event-form").fadeOut("fast",function(){c.find("#details-"+b).fadeIn("fast"),$(this).remove()})}),$("body").on("click","#edit-event-do",function(a){a.preventDefault();var b=$(this).closest(".event-card"),c=$(this).data("event-id"),d=document.getElementById("edit-event-name").value,e=document.getElementById("edit-event-description").value,f=document.getElementById("edit-event-location").value,g=document.getElementById("edit-event-address").value,h=document.getElementById("edit-event-date").value,i=document.getElementById("edit-event-time").value,j=new Date,k=j.getFullYear(h),l=document.getElementById("edit-event-password").value,m=document.getElementById("edit-event-rsvp-deadline").value;return show_loader(),$.ajax({type:"POST",url:"inc/events.php",data:{eventUpdated:c,eventName:d,eventDescription:e,eventLocation:f,eventAddress:g,eventDate:h,eventTime:i,eventPassword:l,eventDeadline:m},success:function(){b.find("h2").html(k+" "+d),b.find(".event-description").html(e),b.find(".event-location").html(f),b.find(".event-address").html(g),b.find(".event-directions").attr("href","http://maps.google.com/?q="+g),b.find(".event-date").html(h),b.find(".event-time").html(i),b.find(".event-password").html(l),""==m&&(m=h),b.find(".event-rsvp-deadline").html(m);var a=document.querySelector("#action-message"),c={message:"This event's details have been updated!"};a.MaterialSnackbar.showSnackbar(c)}}).done(function(){$("#edit-event-form").fadeOut("fast",function(){b.find("#details-"+c).fadeIn("fast"),$(this).remove()}),hide_loader()}),!1}),$(".event-rsvp-switch").change(function(){var a=$(this).data("event-id"),b=$(this).closest(".event-card");if(this.checked)var c=1;else var c=0;return show_loader(),$.ajax({type:"GET",url:"inc/events.php",dataType:"json",data:{rsvpsToggled:a},success:function(d){var e=document.querySelector("#action-message"),f={message:"This event's RSVPs has been toggled!"};e.MaterialSnackbar.showSnackbar(f),c?($("#details-"+a).append('<p id="rsvp-details-'+a+'"><strong>RSVP Password:</strong> <span class="event-password">'+d.password+"</span><br /><strong>Total RSVPs:</strong> 0<br /><strong>Total People Attending:</strong> 0</p>"),$(b).find(".mdl-card__supporting-text").after('<div class="mdl-card__actions mdl-card--border"><a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" href="<?php echo BASE_URL; ?>rsvps/?id='+a+"\">See Who's Coming</a></div>")):($("#rsvp-details-"+a).remove(),$(b).find(".mdl-card__actions").remove())}}).done(function(){hide_loader()}),!1}),$("li.toggle-listing").click(function(a){a.preventDefault();var b=$(this).data("event-id"),c=$(this).closest(".event-card"),d=$(this),e=d.text();return e="Remove Event from Listing"==e?"Add Event to Listing":"Remove Event from Listing",show_loader(),$.ajax({type:"GET",url:"inc/events.php",data:{listingUpdated:b},success:function(){var a=document.querySelector("#action-message"),b={message:"This event's listing has been updated!"};a.MaterialSnackbar.showSnackbar(b),d.html(e),"Remove Event from Listing"==e?($(c).find("h3").replaceWith("<h3>Details</h3>"),$(c).toggleClass("inactive")):($(c).find("h3").replaceWith("<h3>Details &mdash; <em>Inactive</em></h3>"),$(c).toggleClass("inactive"))}}).done(function(){hide_loader()}),!1}),$("li.delete-event").click(function(a){a.preventDefault(),$("body").append('<div class="mdl-card mdl-shadow--6dp" id="confirm-delete"><h3>Are you sure?</h3><p>This will delete this event and all rsvps from the database</p><div class="mdl-card__actions mdl-card--border"><button class="mdl-button mdl-js-button mdl-button--icon mdl-button--accent confirm-delete-btn"><i class="material-icons">delete</i></button><button class="mdl-button mdl-js-button mdl-button--icon mdl-button--primary clear-delete-btn"><i class="material-icons">clear</i></button></div></div>'),$("#confirm-delete").fadeToggle("fast"),$(".clear-delete-btn").click(function(){$("#confirm-delete").fadeToggle("fast",function(){$("#confirm-delete").remove()})});var b=$(this).data("event-id"),c=$(this);$(".confirm-delete-btn").click(function(){return show_loader(),$("#confirm-delete").fadeToggle("fast",function(){$("#confirm-delete").remove()}),$.ajax({type:"GET",url:"inc/events.php",data:{eventDeleted:b},success:function(){var a=document.querySelector("#action-message"),b={message:"This event has been deleted!"};a.MaterialSnackbar.showSnackbar(b)}}).done(function(){hide_loader(),c.closest(".event-card").fadeToggle("slow")}),!1})});
