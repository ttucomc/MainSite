function show_loader(){var e=$("#loader");$("body").css("opacity","0.8"),e.toggleClass("is-active")}function hide_loader(){var e=$("#loader");$("body").css("opacity","1"),e.toggleClass("is-active")}$("#add-event-btn").click(function(){$("#add-event").fadeToggle("fast")}),$("#add-event-do").click(function(){show_loader()}),$("#add-event form .close-btn").click(function(e){e.preventDefault(),$("#add-event").fadeToggle("fast")}),$("li.edit-event").click(function(){var e=$(this).data("event-id"),t=$(this).closest(".event-card"),d=t.find("h2").text().substring(5),a=t.find("span.event-location").text(),n=t.find("span.event-address").text(),l=t.find("span.event-date").text(),i=t.find("span.event-password").text(),s=t.find("span.event-time").text();s.startsWith("0")&&(s=s.substring(1)),t.find("#details-"+e).fadeOut("fast",function(){t.find(".mdl-card__supporting-text").append('<form method="POST" id="edit-event-form"> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-name">Event Name</label> <input class="mdl-textfield__input" type="text" id="edit-event-name" name="edit-event-name" value="'+d+'"> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-location">Location</label> <input class="mdl-textfield__input" type="text" id="edit-event-location" name="edit-event-location" value="'+a+'"> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-address">Address</label> <input class="mdl-textfield__input" type="text" id="edit-event-address" name="edit-event-address" value="'+n+'"> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-date">Date</label> <input class="mdl-textfield__input" type="text" id="edit-event-date" name="edit-event-date" pattern="^([0]?[1-9]|[1][0-2])[./-]([0]?[1-9]|[1|2][0-9]|[3][0|1])[./-]([0-9]{4}|[0-9]{2})$" placeholder="MM/DD/YYYY" value="'+l+'"> <span class="mdl-textfield__error">Please use this format: MM/DD/YYYY</span> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <label class="mdl-textfield__label" for="edit-event-time">Time</label> <input class="mdl-textfield__input" type="text" id="edit-event-time" name="edit-event-time" placeholder="XX:XX AM/PM" pattern="^ *(1[0-2]|[1-9]):[0-5][0-9] *(a|p|A|P)(m|M) *$" value="'+s+'"> <span class="mdl-textfield__error">Please use this format: XX:XX AM/PM</span> </div> <br /> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"><label class="mdl-textfield__label" for="edit-event-password">RSVP Password</label><input class="mdl-textfield__input" type="text" id="edit-event-password" name="edit-event-password" value="'+i+'"></div> <input type="hidden" name="form-name" value="edit-event" /> <div class="form-buttons"> <div class="form-button"> <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored" id="edit-event-do" type="submit" form="edit-event-form" data-event-id="'+e+'"> <i class="material-icons">add</i> </button> </div> <div class="form-button"> <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect edit-close-btn" data-event-id="'+e+'"><i class="material-icons">close</i> </button> </div> </div> </form>').fadeIn(),componentHandler.upgradeDom()})}),$("body").on("click",".edit-close-btn",function(e){e.preventDefault();var t=$(this).data("event-id"),d=$(this).closest(".event-card");$("#edit-event-form").fadeOut("fast",function(){d.find("#details-"+t).fadeIn("fast"),$(this).remove()})}),$("body").on("click","#edit-event-do",function(e){e.preventDefault();var t=$(this).closest(".event-card"),d=$(this).data("event-id"),a=document.getElementById("edit-event-name").value,n=document.getElementById("edit-event-location").value,l=document.getElementById("edit-event-address").value,i=document.getElementById("edit-event-date").value,s=document.getElementById("edit-event-time").value,o=new Date,c=o.getFullYear(i),r=document.getElementById("edit-event-password").value;return show_loader(),$.ajax({type:"POST",url:"inc/events.php",data:{eventUpdated:d,eventName:a,eventLocation:n,eventAddress:l,eventDate:i,eventTime:s,eventPassword:r},success:function(){t.find("h2").html(c+" "+a),t.find(".event-location").html(n),t.find(".event-address").html(l),t.find(".event-directions").attr("href","http://maps.google.com/?q="+l),t.find(".event-date").html(i),t.find(".event-time").html(s),t.find(".event-password").html(r);var e=document.querySelector("#action-message"),d={message:"This event's details have been updated!"};e.MaterialSnackbar.showSnackbar(d)}}).done(function(){$("#edit-event-form").fadeOut("fast",function(){t.find("#details-"+d).fadeIn("fast"),$(this).remove()}),hide_loader()}),!1}),$(".event-rsvp-switch").change(function(){var e=$(this).data("event-id"),t=$(this).closest(".event-card");if(this.checked)var d=1;else var d=0;return show_loader(),$.ajax({type:"GET",url:"inc/events.php",dataType:"json",data:{rsvpsToggled:e},success:function(a){var n=document.querySelector("#action-message"),l={message:"This event's RSVPs has been toggled!"};n.MaterialSnackbar.showSnackbar(l),d?($("#details-"+e).append('<p id="rsvp-details-'+e+'"><strong>RSVP Password:</strong> <span class="event-password">'+a.password+"</span><br /><strong>Total RSVPs:</strong> 0<br /><strong>Total People Attending:</strong> 0</p>"),$(t).find(".mdl-card__supporting-text").after('<div class="mdl-card__actions mdl-card--border"><a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" href="<?php echo BASE_URL; ?>rsvps/?id='+e+"\">See Who's Coming</a></div>")):($("#rsvp-details-"+e).remove(),$(t).find(".mdl-card__actions").remove())}}).done(function(){hide_loader()}),!1}),$("li.toggle-listing").click(function(e){e.preventDefault();var t=$(this).data("event-id"),d=$(this).closest(".event-card"),a=$(this),n=a.text();return n="Remove Event from Listing"==n?"Add Event to Listing":"Remove Event from Listing",show_loader(),$.ajax({type:"GET",url:"inc/events.php",data:{listingUpdated:t},success:function(){var e=document.querySelector("#action-message"),t={message:"This event's listing has been updated!"};e.MaterialSnackbar.showSnackbar(t),a.html(n),"Remove Event from Listing"==n?($(d).find("h3").replaceWith("<h3>Details</h3>"),$(d).toggleClass("inactive")):($(d).find("h3").replaceWith("<h3>Details &mdash; <em>Inactive</em></h3>"),$(d).toggleClass("inactive"))}}).done(function(){hide_loader()}),!1}),$("li.delete-event").click(function(e){e.preventDefault(),$("body").append('<div class="mdl-card mdl-shadow--6dp" id="confirm-delete"><h3>Are you sure?</h3><p>This will delete this event and all rsvps from the database</p><div class="mdl-card__actions mdl-card--border"><button class="mdl-button mdl-js-button mdl-button--icon mdl-button--accent confirm-delete-btn"><i class="material-icons">delete</i></button><button class="mdl-button mdl-js-button mdl-button--icon mdl-button--primary clear-delete-btn"><i class="material-icons">clear</i></button></div></div>'),$("#confirm-delete").fadeToggle("fast"),$(".clear-delete-btn").click(function(){$("#confirm-delete").fadeToggle("fast",function(){$("#confirm-delete").remove()})});var t=$(this).data("event-id"),d=$(this);$(".confirm-delete-btn").click(function(){return show_loader(),$("#confirm-delete").fadeToggle("fast",function(){$("#confirm-delete").remove()}),$.ajax({type:"GET",url:"inc/events.php",data:{eventDeleted:t},success:function(){var e=document.querySelector("#action-message"),t={message:"This event has been deleted!"};e.MaterialSnackbar.showSnackbar(t)}}).done(function(){hide_loader(),d.closest(".event-card").fadeToggle("slow")}),!1})});
